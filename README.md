# Сеть ветеринарных клиник. Реализуется база данных учета заказов сети клиник.
## Функциональные требования:
### Аналитические:
*	Отчет по продажам
*	Отчет состояния заказ
*	Вычисление итоговой стоимости 
*	Вычисление процента от продаж сотрудникам
*	Подсчет статистики по заболеваниям
### Оперативные:
*	Показ состояния приема
*	Показ лекарственных средств
*	Покупка лекарственных средств
*	Подробная информация о болезни 
*	Запись на прием
*	Отмена приема
### Плановые:
*	Уведомление о скидке в день рождение 
*	Уведомление о скидки в праздники
*	Отсылка месячного отчета на почту
*	Отсылка квартального отчета на почту
*	Уведомление о повторном приеме
### Транзакционные:
*	Добавление заказа
*	Отмена заказа
*	Добавить болезнь
*	Изменить лекарства
*	Изменить болезнь

## Нефункциональные требования:  
Будут две версии приложения: Мобильная и web. В этих приложениях можно будет записать на прием в одну из ближайших клиник. Запись производится зарегистрированными пользователями. Так же будет Админ-панель, в котором можно увидеть полную статистику клиники и других филиалов, а так же отчеты по продажам лекарственных средств.
 
## Связи
*   Сотрудник имеет должность
*   Сотрудник оформляет прием к врачу
*	Клиент создает прием
*	Клиент имеет животное
*	Прием хранит животное
*	Животное имеет болезнь и состояние
*	Болезнь имеет лечение
*	Лечение требует(имеет) лекарства
*	Филиал имеет сотрудников

# Логическое проектирование
### ER диаграмма
![alt text](img/er.png?raw=true "ER диаграмма")
### Логическая схема
![alt text](img/er_logical.png?raw=true "Логическая ER диаграмма")
![alt text](img/er_logical_end.png?raw=true "Логическая ER диаграмма")

#### Заполнение базы данных
![alt text](img/1.png?raw=true "Users")
![alt text](img/2.png?raw=true "Reception")
![alt text](img/3.png?raw=true "Treatment_to_medicine")
![alt text](img/4.png?raw=true "Positions")
![alt text](img/5.png?raw=true "medicine")
![alt text](img/6.png?raw=true "Employers")
![alt text](img/7.png?raw=true "States")
![alt text](img/8.png?raw=true "Reception_to_Disease")
![alt text](img/9.png?raw=true "breeds")
![alt text](img/10.png?raw=true "Animals")
![alt text](img/11.png?raw=true "Branches")

# База данных одногруппника
#### Сгенерированная ER диаграмма
![alt text](img/chart.svg?raw=true "Сгенерированная ER диаграмма")
#### Оригинал
![alt text](img/orig.jpg?raw=true "ER диаграмма одногруппника")

### Скрипты к 3 лабораторной работе
Все скрипты представленный в папке scripts
* /scripts/lab3_db.sql - создание базы данных
* /scripts/lab3_fix_db.sql - alter table
* /scripts/lab3_delete_db.sql - удаление базы данных

#### Скриншоты работы

## Результаты работы EXPLAIN
До добавления индексов время выполнения 5 сложных запросов составило 0,613 секунд
### Схемы вызовов
1. ![alt text](img/plan1.png "74 запрос")
1. ![alt text](img/plan2_1.png "75 запрос")
   ![alt text](img/plan2_2.png "75 запрос")
   ![alt text](img/plan2_3.png "75 запрос")
1. ![alt text](img/plan3.png "76 запрос")
1. ![alt text](img/plan4.png "77 запрос")
1. ![alt text](img/plan5.png "78 запрос")
Подробнее с планами можно ознакомится в папке /plans
   После добавления индексов время исполнения тех же 5 запросов составило 0,217 секунд
   Скорость обработки увеличилась примерно в 3 раза
### Схемы вызовов
1. ![alt text](img/planAfter1.png "74 запрос")
1. ![alt text](img/planAfter2_1.png "75 запрос")
   ![alt text](img/planAfter2_2.png "75 запрос")
   ![alt text](img/planAfter2_3.png "75 запрос")
   ![alt text](img/planAfter2_4.png "75 запрос")
   ![alt text](img/planAfter2_5.png "75 запрос")
1. ![alt text](img/planAfter3.png "76 запрос")
1. ![alt text](img/planAfter4.png "77 и 78 запросы")

## Остальные скрипты
Остальные скрипты 5 работы лежат в /scripts/lab_5.sql
5 сложных функций лежат в /scripts/top3_hard_queries.sql

## Реализация 
Реализация лежит в папке webapp
Написано на языке php
Для связи с базой данных использовался класс PDO